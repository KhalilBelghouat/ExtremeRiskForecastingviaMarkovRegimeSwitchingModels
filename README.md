# Extreme Risk Forecasting via Markov Regime-Switching Models: Evidence from the Moroccan All Shares Index

This repository includes the code used in one of the master's projects "Extreme Risk Forecasting via Markov Regime-Switching Models: Evidence from the Moroccan All Shares Index" by Khalil Belghouat.

In this project, a Markov regime-switching extreme value theory approach is followed in order to model and forecast the tail risk of the Moroccan All Shares Index.

## Prerequisites

The ```R``` programming language, version 4.2.0, and its statistical and machine learning libraries were used to build all applied models. The ```R``` script _packages.R_ in the _packages_ folder installs and loads all necessary ```R``` packages. 

All operations, from data preprocessing to model estimation, were carried out on the Google Colaboratory platform.

## Theoretical Background

So far in the literature, two models have been developed that capture the time-varying autocorrelated volatility process: the stochastic volatility model and that of GARCH (Generalized Autoregressive Conditional Heterscedasticity). In the stochastic volatility model, the variance is modeled as a latent component that follows a stochastic process. While GARCH models define time-varying variance as a deterministic function of past squared innovations and lagged conditional variances. Multiple extensions of GARCH's sedastic function have been proposed to capture additional stylized facts observed in financial and economic time series, such as non-linearities, asymmetries, and long memory properties. GARCH-type models are, until now, widely used to model various financial phenomena such as risk management of futures contracts, estimation of the volatility of yield spreads, and portfolio optimization. However, various studies have shown that one of the most problematic features of these models is the excessive persistence attributed to the volatility of financial variables. This suggests that conditional variance shocks that arose in the distant past continue to have sizeable effects on the present value. This long-lasting persistence is in fact the reason attributed to the relatively poor forecasts of the GARCH models. A number of researchers have observed that the high persistence of GARCH models and therefore poor forecasting performance could be related to structural changes in the data generating process. And pointed out that GARCH models may be limited in their ability to model the volatility of financial time series if structural breaks, caused by some dramatic events such as financial crises, recessions or changes in government policies, are present. Therefore, Markov regime-switching GARCH models, as introduced by James D. Hamilton and several other econometers, were advanced and found to be useful in solving this problem. These models allow the conditional volatility process to switch between a discrete number of states, the transitions between states being governed by a Markov chain of hidden and finite order. More often than not, such a structure has been found to improve the forecasting of volatility and risk. The Markov regime-switching model and its variants have found application in the analysis of the fluctuation of interest rates and exchange rates, forecasting business cycles, and portfolio management for hedging against financial risks. In this paper, we conduct an empirical analysis of the Moroccan All Shares Index using several Markov regime-switching GARCH specifucations. We also study, combined with extreme value theory, their forecasting performance in estimating VaR.

## Application and Results

Nous remarquons que, pour toutes les spécifications de volatilité et de distribution, les modèles à changement de régime markovien offrent un meilleur compromis entre la qualité d'ajustement et la complexité du modèle que leurs homologues à régime unique. En outre, nous notons que pour toutes les spécifications de régime, les distributions asymétriques et à queues loudres sont largement préférées. Le modèle GARCH à trois régimes avec une distribution Student-t s'avère être le meilleur ajustement à nos données en se basant sur le critère d'information d'Akaike, 9232.1672. Alors que le modèle GARCH standard à un seul régime avec une distribution Student-t s'est avéré le meilleur en se basant sur le critère d'information bayésien, 9306.0622. Un point soulevé par plusieurs chercheurs est que les critères d’information d'Akaike et bayésien sont appropriés pour des tâches différentes. En particulier, le critère d’information bayésien est considéré comme approprié pour sélectionner le soi-disant vrai modèle parmi l'ensemble des modèles candidats, alors que le critère d’information d'Akaike n'est pas approprié. Les partisans du critère d’information d'Akaike soutiennent que ce problème est négligeable, car le vrai modèle n'est pratiquement jamais dans l'ensemble candidat. Dans une étude de simulation par Scott I. Vrieze, il a été démontré que le critère d’information d'Akaike sélectionne parfois un bien meilleur modèle que son homologue bayésien même lorsque le vrai modèle est dans l'ensemble candidat. La raison en est que, pour n fini, le critère d’information bayésien peut avoir un risque substantiel de sélectionner un très mauvais modèle dans l'ensemble des candidats. Avec le critère d’information d'Akaike, le risque de sélectionner un très mauvais modèle est minimisé. La volatilité des rendements du MASI est séparée en trois régimes: un régime à forte volatilité, un régime à moyenne volatilité et un régime à faible volatilité. Le régime à forte volatilité est lié à des écarts de rendements considérablement élevés, le régime à volatilité moyenne est lié à des écarts de rendements moyennement élevés et le régime à faible volatilité est lié à une faible fluctuation des rendements. Les estimations des paramètres indiquent que l'évolution du processus de volatilité est hétérogène entre les trois régimes. En effet, les trois régimes rapportent des niveaux de volatilité inconditionnelle différents: 9.0437% dans le premier régime, 9.7334% dans le deuxième régime et 20.8600% dans le troisième. De plus, la persistance de la volatilité dans chacun des régimes est différente. Le premier régime rapporte 0.8046, le deuxième régime rapporte 0.5605, tandis que le troisième rapporte 0.8960. Les probabilités stables indiquent que la probabilité d'être dans le premier régime est de 0.4330, alors qu'être dans le deuxième ou le troisième est de, respectivement, 0.4049 et 0.1621. Ainsi, la probabilité estimée de rester dans le même régime au cours de la période suivante est élevée pour les trois régimes, dépassant les 95%. Alors que les probabilités associées au passage d'un régime à un autre sont très faibles. 

